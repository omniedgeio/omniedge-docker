# OmniEdge Docker Compose
#
# Quick Start:
#   1. Copy .env.example to .env and fill in your values
#   2. Run: docker compose up -d
#
# The default service uses environment variables for configuration.
# Uncomment additional services if you need nucleus or dual mode.

services:
  # Default: Edge mode (VPN client)
  # Just set OMNIEDGE_NETWORK_ID and OMNIEDGE_SECURITY_KEY in .env
  omniedge:
    image: omniedge/omniedge:latest
    container_name: omniedge
    privileged: true
    network_mode: host
    restart: unless-stopped
    env_file:
      - .env
    volumes:
      - /dev/net/tun:/dev/net/tun
    cap_add:
      - NET_ADMIN

  # Nucleus mode - Signaling server only (uncomment to use)
  # Set OMNIEDGE_MODE=nucleus and OMNIEDGE_SECRET in .env
  # omniedge-nucleus:
  #   image: omniedge/omniedge:latest
  #   container_name: omniedge-nucleus
  #   network_mode: host
  #   restart: unless-stopped
  #   environment:
  #     - OMNIEDGE_MODE=nucleus
  #   env_file:
  #     - .env

  # Dual mode - VPN + Signaling (uncomment to use)
  # Set OMNIEDGE_MODE=dual, OMNIEDGE_NETWORK_ID, OMNIEDGE_SECURITY_KEY, and OMNIEDGE_SECRET in .env
  # omniedge-dual:
  #   image: omniedge/omniedge:latest
  #   container_name: omniedge-dual
  #   privileged: true
  #   network_mode: host
  #   restart: unless-stopped
  #   environment:
  #     - OMNIEDGE_MODE=dual
  #   env_file:
  #     - .env
  #   volumes:
  #     - /dev/net/tun:/dev/net/tun
  #   cap_add:
  #     - NET_ADMIN
